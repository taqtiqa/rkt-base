language: generic
#Build order
#    before_install
#    install
#    before_script
#    script
#    after_success / after_failure
#    after_script
#
#After the the after_script has run.
#
#    before_deploy
#    deploy
#    after_deploy


notifications:
  email:
    recipients:
      - coders@taqtiqa.com
    on_success: [always]
    on_failure: [always]

env:
  global:
    - secure: F3QQsrfFhSgn7S+awB02Xo9FF1LonNfsCHP6aVe+3mfGbtU4xXh1ACBqPiOf4N+WBEsVvNtEZe9gCg63vNJ3t/TeoZoau69G2ii6SKCaJIxI0k4hYT+X2FkVBgwCFvg7YQpphYkvsgQf2QKCwoVWJ7l7qnpvcd17imL4LBQPCLQGgjIELNtFtdM0KVIhHOvkEIQryHbla50zvOGm/JfqF1kE+3cKAcz3UjRHmEYJD6Pdl0kvBAxx/qeHgwpNlr/PS7hAzUxhTby60N7Jb+TEnUpufYwKScT3gW1UqFLQp5Fy6QLfCsURPth+VmLiBvyKQTQ87P3TP3O+PqgsVxpMHTF+vCKsAMD6uW2C7Ly6vCzARwMXU9whJeee7fr1PD3e46XpA1SuqvkUh7EdU51zb56X9wkQiD395TOuVtS0YCN+pd3ujM1AaixBJKp+Z8Yl8EWPRCmxwkiZB3YKQR2dsc0mPk3B8QM/FCFHw62V6TkH93pb0AbsjXnPA/xwL2eI2Xm2+ZFKY0KCzT3bIMJ2xShyHSNmEmBMhHBRC+9iIPfyDRXq+cSXJwfss/Da5b0+/Uof9cN892a6h8076Z+9maG1euYe+aGeLLJClEy0B8uaXH6B/iXY8YK20b+bKQScfcRG9slHAVKg8kooGSbOALUopjPiqfZenXXMo8odl6I=
  matrix:
    - ARCH=amd64

before_install:
  - git clone https://github.com/taqtiqa/ci.git
  - cat ci/travis/install-acbuild.sh | sudo bash # pipe to bash not sh!

before_script:
  - openssl aes-256-cbc -pass env:ACI_SECRET -in ./rkt-base-privatekeys.gpg.enc -out ./rkt-base-privatekeys.gpg -d -a

script: cat ./rkt-base.sh | sudo bash

after_script: # here's a build step block
  - echo "We can put normal shell commands here"
  - echo "more shell commands here"

before_deploy:
  - echo 'ready?'
  - cat ./scripts/deploy.sh | bash

deploy:
  - provider: releases
    api_key:
      secure: "UEsvVGh3SzlQRVVCjAy8XSYOxXpFQtN0BO1vBl2dmrK+7XDeNrzNaFwcW9P6+TuZqGY5+GAdc2GT0WZ0sBXWTU9Orjr1kBn24TCK/N8wPbybzb8+UQS5jUD8D0aOH2tXnTI2eslRPBhcOmrP+HMrJG/kz8jwVolbfheSKsmMhw+wdekUdetm4q1dhncDIN4DeZLGzTUqfjjevXA6cyIDPngu61Pekr5+MAcKu3Q2v+KHdLYym39uytT8sF70zMYPsvGRxv7P9kBiJ30869AVE4XeWyLYh/I3xDLQA1TMh3CvQjepXIhnKaqpLeI4Qji6vwo8nloaPBj9SL02iXFVtKlCy3UohlyAke+jaJo3HLy2KfE8FkYGFjTvq9HId+wGdVHtj2giRNJClUSfAoQgWwVImGawAUJEMn78uIRjEXEUjGcS4cyliVt7n6OCYjnT2Nsu2X4mNeiyFq5u7mc+YynGGt381vnsxWd3iC/AgMrijcgY2D9mgtTR7tOEervpnziojhjBRcI8C3LPmMxvyWUCeXSKjj0TR1RBsIx+k4A7qeapGYrwTbklp6Kuuj6iTSTv6KYgA8IR91c/DcGtkvNtJzSuh+C2mBgFVNH1z1WeS0903nTZg+kyIPYmnNu/PmRoJq/Wm+lSyKh9ZbR68bPoP09JV61OYgPKkXgZHb0="
    file:
      - "${ACI_NAME}-${TRAVIS_TAG}-linux-${ARCH}.aci"
      - "${ACI_NAME}-${TRAVIS_TAG}-linux-${ARCH}.aci.asc"
    skip_cleanup: true
    on:
      repo: $TRAVIS_REPO_SLUG
      tags: true
      all_branches: true
      condition: "$TRAVIS_TAG =~ ^[0-9][0-9.]*$"
  - provider: pages
    skip_cleanup: true
    github_token:
      secure: "UEsvVGh3SzlQRVVCjAy8XSYOxXpFQtN0BO1vBl2dmrK+7XDeNrzNaFwcW9P6+TuZqGY5+GAdc2GT0WZ0sBXWTU9Orjr1kBn24TCK/N8wPbybzb8+UQS5jUD8D0aOH2tXnTI2eslRPBhcOmrP+HMrJG/kz8jwVolbfheSKsmMhw+wdekUdetm4q1dhncDIN4DeZLGzTUqfjjevXA6cyIDPngu61Pekr5+MAcKu3Q2v+KHdLYym39uytT8sF70zMYPsvGRxv7P9kBiJ30869AVE4XeWyLYh/I3xDLQA1TMh3CvQjepXIhnKaqpLeI4Qji6vwo8nloaPBj9SL02iXFVtKlCy3UohlyAke+jaJo3HLy2KfE8FkYGFjTvq9HId+wGdVHtj2giRNJClUSfAoQgWwVImGawAUJEMn78uIRjEXEUjGcS4cyliVt7n6OCYjnT2Nsu2X4mNeiyFq5u7mc+YynGGt381vnsxWd3iC/AgMrijcgY2D9mgtTR7tOEervpnziojhjBRcI8C3LPmMxvyWUCeXSKjj0TR1RBsIx+k4A7qeapGYrwTbklp6Kuuj6iTSTv6KYgA8IR91c/DcGtkvNtJzSuh+C2mBgFVNH1z1WeS0903nTZg+kyIPYmnNu/PmRoJq/Wm+lSyKh9ZbR68bPoP09JV61OYgPKkXgZHb0="
    branch: master
    local_dir: gh-pages/
    target_branch: gh-pages
    on:
      repo: $TRAVIS_REPO_SLUG
      tags: true
      all_branches: true
      condition: "$TRAVIS_TAG =~ ^[0-9][0-9.]*$"

after_deploy:
  - echo "We can put normal shell commands here"
